#!/bin/sh
# Run the Bitmunk app as a peer in valgrind

case "`uname -s`" in
   [Ll]inux)
      PLATFORM=linux ;;
   [Dd]arwin)
      PLATFORM=macos ;;
   *) echo "unknown platform"; exit 1 ;;
esac
@BITMUNK_DIR@/bitmunk-run valgrind \
	--suppressions=bitmunk.supp \
	--show-reachable=yes \
	--tool=memcheck \
	--leak-check=full \
	@BITMUNK_DIR@/dist/bin/bitmunk \
	--log-color \
	--log-level m \
	--system-config configs/dev-bpe.config \
	"$@"
