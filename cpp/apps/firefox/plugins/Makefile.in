SOURCES = BitmunkMimetypePlugin.cpp
COMPONENT_LIBRARIES = npbmd

CXX_FLAGS = @XULRUNNER_CXX_FLAGS@
LD_FLAGS = @XULRUNNER_LD_FLAGS@

# ----------- Standard Makefile
include @BITMUNK_DIR@/setup/Makefile.base

# ---------- Platform specific flags
DYNAMIC_LINUX_LIBRARIES += xpcomglue_s xpcom

MACOS_CXX = g++ -isysroot /Developer/SDKs/MacOSX10.4u.sdk
MACOS_CXX_FLAGS += -g -DMOZILLA_STRICT_API -DXP_UNIX -DXP_MACOSX -include "mozilla-config.h" -Wno-ctor-dtor-privacy -Wno-non-virtual-dtor -fno-rtti -I build/macos -I /Developer/SDKs/MacOSX10.4u.sdk/Developer/Headers/FlatCarbon
MACOS_CXX_INCLUDES += -I build -I /usr/local/gecko-sdk/include -I /usr/local/gecko-sdk/include/java -I /usr/local/gecko-sdk/include/plugin -I /usr/local/gecko-sdk/include/xpcom -I /usr/local/gecko-sdk/include/string -I /opt/local/include -I /opt/local/include  -I /usr/local/gecko-sdk/include -I /Developer/SDKs/MacOSX10.4u.sdk/Developer/Headers/FlatCarbon
MACOS_LD_FLAGS = @LDFLAGS@ -Wl,-executable_path,/Library/Frameworks/XUL.framework/Versions/Current
DYNAMIC_MACOS_LIBRARIES += xpcomglue_s xpcom nspr4 plds4 plc4

@BITMUNK_DIR@/dist/lib/libbitmunk-mimehandler.dylib:
	g++ -isysroot /Developer/SDKs/MacOSX10.4u.sdk -dynamiclib -o @BITMUNK_DIR@/dist/lib/libbitmunk-mimehandler.dylib $(MACOS_BUILD_DIR)/BitmunkMimetypePlugin-macos.o  -L/usr/local/gecko-sdk/lib -lxpcomglue_s -lxpcom -lnspr4 -lplds4 -lplc4 -Wl,-executable_path,/Library/Frameworks/XUL.framework/Versions/Current -framework XUL
