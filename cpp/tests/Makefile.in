# Makefile to compile the module in this directory

# FIXME: All of the .h files that the bmtest library depends on should be
# split out into a headerfile in the bmtest library.
HEADERS = $(wildcard *.h)
HEADER_DIST_DIR = dist/internal/include/bitmunk/tests

# conditional build of tests
ifeq (@BUILD_TESTS@,yes)

# conditional GTK build
ifeq (@BUILD_GTK_UI@,yes)
GTK_SOURCES = test-gtkbuilder.cpp
GTK_TESTS = \
	test-gtkbuilder
endif

SOURCES = \
	bfp-file-id.cpp \
	format-detect.cpp \
	profile-creator.cpp \
	test-common.cpp \
	test-config.cpp \
	test-customcatalog.cpp \
	test-download-states.cpp \
	test-eventreactor.cpp \
	test-node-services.cpp \
	test-peerbuy.cpp \
	test-piece-upload.cpp \
	test-secure-ping.cpp \
	test-services-filesystem.cpp \
	test-services-customcatalog.cpp \
	test-services-medialibrary.cpp \
	test-statemonitor.cpp \
	bitmunk-unit-tests.cpp \
	$(GTK_SOURCES)

EXECUTABLES = \
	bfp-file-id \
	format-detect \
	profile-creator \
	test-common \
	test-config \
	test-customcatalog \
	test-download-states \
	test-eventreactor \
	test-node-services \
	test-peerbuy \
	test-piece-upload \
	test-secure-ping \
	test-services-filesystem \
	test-services-customcatalog \
	test-services-medialibrary \
	test-statemonitor \
	bitmunk-unit-tests \
	$(GTK_TESTS)

DYNAMIC_LINK_LIBRARIES = mort momodest moutil moio mologging mocompress mocrypto monet mohttp modata mosql mosqlite3 $(MYSQL_DYNAMIC_LINK_LIBRARIES) moevent mofiber momail moconfig moupnp motest movalidation $(SPHINX_DYNAMIC_LINK_LIBRARIES) moapp mokernel bmcommon bmdata $(DATABASE_DYNAMIC_LINK_LIBRARIES) bmprotocol bmnode $(PERMISSION_DYNAMIC_LINK_LIBRARIES) bmbfp bmcustomcatalog bmpurchase bmsell $(MAIL_DYNAMIC_LINK_LIBRARIES) $(MEDIA_DYNAMIC_LINK_LIBRARIES) $(UVA_DYNAMIC_LINK_LIBRARIES)
DYNAMIC_EXECUTABLE_LIBRARIES = bmtest
DYNAMIC_LINUX_LIBRARIES = pthread crypto ssl expat sqlite3 $(MYSQL_DYNAMIC_LINUX_LIBRARIES)
DYNAMIC_WINDOWS_LIBRARIES = sqlite3 $(MYSQL_DYNAMIC_WINDOWS_LIBRARIES)
DYNAMIC_MACOS_LIBRARIES = crypto ssl

EXTRA_WINDOWS_LIBRARIES = $(WINDOWS_LIB_DIR)/pthreadGCE2.dll $(WINDOWS_LIB_DIR)/libeay32.dll $(WINDOWS_LIB_DIR)/ssleay32.dll $(WINDOWS_LIB_DIR)/libexpat.dll $(WINDOWS_LIB_DIR)/sqlite3.dll $(WINDOWS_LIB_DIR)/iconv2.dll $(WINDOWS_LIB_DIR)/charset1.dll $(MYSQL_EXTRA_WINDOWS_LIBRARIES) -lws2_32

# conditional build of tests
endif

# ----------- Standard Makefile
include @BITMUNK_DIR@/setup/Makefile.base
